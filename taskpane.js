/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"a1eeec2cb0a3e6b0928e.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var c=t[r]={exports:{}};return e[r](c,c.exports,n),c.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},c=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function i(e,o,c,a){var i=o&&o.prototype instanceof u?o:u,l=Object.create(i.prototype);return t(l,"_invoke",function(e,t,o){var c,a,i,u=0,l=o||[],f=!1,p={p:0,n:0,v:n,a:d,f:d.bind(n,4),d:function(e,t){return c=e,a=0,i=n,p.n=t,s}};function d(e,t){for(a=e,i=t,r=0;!f&&u&&!o&&r<l.length;r++){var o,c=l[r],d=p.p,y=c[2];e>3?(o=y===t)&&(a=c[4]||3,i=c[5]===n?c[3]:c[5],c[4]=3,c[5]=n):c[0]<=d&&((o=e<2&&d<c[1])?(a=0,p.v=t,p.n=c[1]):d<y&&(o=e<3||c[0]>t||t>y)&&(c[4]=e,c[5]=t,p.n=y,a=0))}if(o||e>1)return s;throw f=!0,t}return function(o,l,y){if(u>1)throw TypeError("Generator is already running");for(f&&1===l&&d(l,y),a=l,i=y;(r=a<2?n:i)||!f;){c||(a?a<3?(a>1&&(p.n=-1),d(a,i)):p.n=i:p.v=i);try{if(u=2,c){if(a||(o="next"),r=c[o]){if(!(r=r.call(c,i)))throw TypeError("iterator result is not an object");if(!r.done)return r;i=r.value,a<2&&(a=0)}else 1===a&&(r=c.return)&&r.call(c),a<2&&(i=TypeError("The iterator does not provide a '"+o+"' method"),a=1);c=n}else if((r=(f=p.n<0)?i:e.call(t,p))!==s)break}catch(e){c=n,a=1,i=e}finally{u=1}}return{value:r,done:f}}}(e,c,a),!0),l}var s={};function u(){}function l(){}function f(){}r=Object.getPrototypeOf;var p=[][c]?r(r([][c]())):(t(r={},c,(function(){return this})),r),d=f.prototype=u.prototype=Object.create(p);function y(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,t(e,a,"GeneratorFunction")),e.prototype=Object.create(d),e}return l.prototype=f,t(d,"constructor",f),t(f,"constructor",l),l.displayName="GeneratorFunction",t(f,a,"GeneratorFunction"),t(d),t(d,a,"Generator"),t(d,c,(function(){return this})),t(d,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:i,m:y}})()}function t(e,n,r,o){var c=Object.defineProperty;try{c({},"",{})}catch(e){c=0}t=function(e,n,r,o){if(n)c?c(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r;else{var a=function(n,r){t(e,n,(function(e){return this._invoke(n,r,e)}))};a("next",0),a("throw",1),a("return",2)}},t(e,n,r,o)}function n(e,t,n,r,o,c,a){try{var i=e[c](a),s=i.value}catch(e){return void n(e)}i.done?t(s):Promise.resolve(s).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,c){var a=e.apply(t,r);function i(e){n(a,o,c,i,s,"next",e)}function s(e){n(a,o,c,i,s,"throw",e)}i(void 0)}))}}Office.onReady((function(e){e.host===Office.HostType.Outlook&&(document.getElementById("submit-to-llm").onclick=i,document.getElementById("reply-with-content").onclick=u,document.getElementById("discard-response").onclick=l)}));var o="";function c(e){return a.apply(this,arguments)}function a(){return(a=r(e().m((function t(n){var r,o,c,a,i,s,u,l,f;return e().w((function(e){for(;;)switch(e.n){case 0:return(r=document.getElementById("status-message")).innerText="Analyzing email with AI (calling Gradio)...",o=Office.context.mailbox.item.itemId||"outlook-addin-session-default",e.p=1,e.n=2,fetch("".concat("http://localhost:8082").concat("/run/predict"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({fn_index:0,data:[o,n,[],null],api_name:"/chat_response"})});case 2:if((c=e.v).ok){e.n=4;break}return e.n=3,c.json();case 3:throw a=e.v,console.error("Gradio API Error Response:",a),new Error("Gradio API error! Status: ".concat(c.status,", Message: ").concat(a.detail||a.error||c.statusText));case 4:return e.n=5,c.json();case 5:if(i=e.v,console.log("Gradio API Response:",i),s=i.data[1],u="",!(s&&s.length>0)){e.n=6;break}(l=s[s.length-1])&&"assistant"===l.role&&l.content&&(u=l.content),e.n=7;break;case 6:throw new Error("Gradio API response did not contain expected chat display output.");case 7:return r.innerText="",e.a(2,u);case 8:return e.p=8,f=e.v,console.error("Error calling Gradio LLM API:",f),r.innerText="Error: Could not get AI response from Gradio. Check console for details.",e.a(2,"Error: Failed to connect to Gradio AI: ".concat(f.message))}}),t,null,[[1,8]])})))).apply(this,arguments)}function i(){return s.apply(this,arguments)}function s(){return s=r(e().m((function t(){var n,a,i;return e().w((function(t){for(;;)switch(t.n){case 0:n=document.getElementById("llm-response-area"),a=document.getElementById("llm-response-text"),i=document.getElementById("status-message"),n.style.display="none",a.value="",i.innerText="Fetching email content...",o="",Office.context.mailbox.item.itemType===Office.MailboxEnums.ItemType.Message?Office.context.mailbox.item.body.getAsync(Office.CoercionType.Text,function(){var t=r(e().m((function t(r){var s,u;return e().w((function(e){for(;;)switch(e.n){case 0:if(r.status!==Office.AsyncResultStatus.Succeeded){e.n=5;break}return s=r.value,console.log("Email Body Retrieved:",s),e.p=1,e.n=2,c(s);case 2:o=e.v,a.value=o,n.style.display="block",i.innerText="AI analysis complete.",e.n=4;break;case 3:e.p=3,u=e.v,console.error("Failed to get LLM response:",u),a.value="Error: Could not get AI response.",n.style.display="block",i.innerText="Error: Failed to get AI response.";case 4:e.n=6;break;case 5:console.error("Error getting email body:",r.error),i.innerText="Error: Could not retrieve email body. ".concat(r.error.message);case 6:return e.a(2)}}),t,null,[[1,3]])})));return function(e){return t.apply(this,arguments)}}()):i.innerText="Please select an email to analyze.";case 1:return t.a(2)}}),t)}))),s.apply(this,arguments)}function u(){var e=Office.context.mailbox.item,t=document.getElementById("status-message");if(o){var n="Recipient";e.itemType===Office.MailboxEnums.ItemType.Message&&e.sender&&e.sender.displayName&&(n=e.sender.displayName.split(" ")[0]||"Recipient");var r="Dear ".concat(n,",\n\n").concat(o,"\n\nBest regards,\n[Your Name]");e.displayReplyForm({htmlBody:r,subject:"Re: ".concat(e.subject||"No Subject")},(function(e){e.status===Office.AsyncResultStatus.Succeeded?(t.innerText="Reply draft created successfully!",l()):(t.innerText="Error creating reply draft: ".concat(e.error.message),console.error("Error creating reply draft:",e.error))}))}else t.innerText="No AI content to reply with."}function l(){var e=document.getElementById("llm-response-area"),t=document.getElementById("llm-response-text"),n=document.getElementById("status-message");e.style.display="none",t.value="",o="",n.innerText="Response discarded."}}(),function(){"use strict";new URL(n(58394),n.b)}()}();
//# sourceMappingURL=taskpane.js.map