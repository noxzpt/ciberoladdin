/*! For license information please see taskpane.js.LICENSE.txt */
!function(){var e={58394:function(e,t,n){"use strict";e.exports=n.p+"24eb6334a7eccc587312.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",c=o.toStringTag||"@@toStringTag";function a(e,o,i,c){var a=o&&o.prototype instanceof u?o:u,l=Object.create(a.prototype);return t(l,"_invoke",function(e,t,o){var i,c,a,u=0,l=o||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return i=e,c=0,a=n,f.n=t,s}};function p(e,t){for(c=e,a=t,r=0;!d&&u&&!o&&r<l.length;r++){var o,i=l[r],p=f.p,m=i[2];e>3?(o=m===t)&&(c=i[4]||3,a=i[5]===n?i[3]:i[5],i[4]=3,i[5]=n):i[0]<=p&&((o=e<2&&p<i[1])?(c=0,f.v=t,f.n=i[1]):p<m&&(o=e<3||i[0]>t||t>m)&&(i[4]=e,i[5]=t,f.n=m,c=0))}if(o||e>1)return s;throw d=!0,t}return function(o,l,m){if(u>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,m),c=l,a=m;(r=c<2?n:a)||!d;){i||(c?c<3?(c>1&&(f.n=-1),p(c,a)):f.n=a:f.v=a);try{if(u=2,i){if(c||(o="next"),r=i[o]){if(!(r=r.call(i,a)))throw TypeError("iterator result is not an object");if(!r.done)return r;a=r.value,c<2&&(c=0)}else 1===c&&(r=i.return)&&r.call(i),c<2&&(a=TypeError("The iterator does not provide a '"+o+"' method"),c=1);i=n}else if((r=(d=f.n<0)?a:e.call(t,f))!==s)break}catch(e){i=n,c=1,a=e}finally{u=1}}return{value:r,done:d}}}(e,i,c),!0),l}var s={};function u(){}function l(){}function d(){}r=Object.getPrototypeOf;var f=[][i]?r(r([][i]())):(t(r={},i,(function(){return this})),r),p=d.prototype=u.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,c,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,t(p,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,c,"GeneratorFunction"),t(p),t(p,c,"Generator"),t(p,i,(function(){return this})),t(p,"toString",(function(){return"[object Generator]"})),(e=function(){return{w:a,m:m}})()}function t(e,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,r,o){if(n)i?i(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r;else{var c=function(n,r){t(e,n,(function(e){return this._invoke(n,r,e)}))};c("next",0),c("throw",1),c("return",2)}},t(e,n,r,o)}function n(e,t,n,r,o,i,c){try{var a=e[i](c),s=a.value}catch(e){return void n(e)}a.done?t(s):Promise.resolve(s).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(o,i){var c=e.apply(t,r);function a(e){n(c,o,i,a,s,"next",e)}function s(e){n(c,o,i,a,s,"throw",e)}a(void 0)}))}}document.addEventListener("DOMContentLoaded",(function(){var t=document.getElementById("submit-to-llm"),n=document.getElementById("llm-response-area"),o=document.getElementById("llm-response-html-preview"),i=document.getElementById("reply-with-content"),c=document.getElementById("discard-response"),a=document.getElementById("status-message"),s=document.getElementById("action-select"),u=document.getElementById("user-query-input"),l=document.getElementById("toggle-options"),d=document.getElementById("ai-options-content"),f=document.getElementById("toggle-arrow"),p="";d.classList.add("expanded"),f.classList.add("expanded"),l.addEventListener("click",(function(){d.classList.toggle("expanded"),f.classList.toggle("expanded")})),Office.onReady(function(){var t=r(e().m((function t(n){return e().w((function(e){for(;;)switch(e.n){case 0:n.host===Office.HostType.Outlook&&console.log("Office.js is ready for Outlook host.");case 1:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}()),t.addEventListener("click",r(e().m((function t(){var i,c,l,m,y;return e().w((function(t){for(;;)switch(t.n){case 0:return d.classList.remove("expanded"),f.classList.remove("expanded"),t.p=1,a.textContent="⏳ Extracting email body and user info...",i=Office.context.mailbox.userProfile.emailAddress,console.log("Current user email:",i),c=s.value,console.log("Selected action:",c),l=u.value.trim(),console.log("Custom query:",l),m="","reply"===c?m="Please generate a reply to this email. ":"summarize"===c&&(m="Please summarize this email concisely. "),l&&(m+='Additionally, consider this instruction: "'.concat(l,'".')),t.n=2,Office.context.mailbox.item.body.getAsync("html",function(){var t=r(e().m((function t(r){var s,l,d,f,y,v,g;return e().w((function(e){for(;;)switch(e.n){case 0:if(r.status!==Office.AsyncResultStatus.Succeeded){e.n=5;break}return l=r.value,d={email_body:l,query:m,email_addr:i,action:c},a.textContent="📡 Sending request to LLM...",e.n=1,fetch("http://localhost:8082/api/ask",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});case 1:if((f=e.v).ok){e.n=3;break}return e.n=2,f.text();case 2:throw y=e.v,new Error("Server responded with status ".concat(f.status,": ").concat(y));case 3:return e.n=4,f.json();case 4:v=e.v,g=(null===(s=v.result)||void 0===s?void 0:s.answer)||"⚠️ No response received.",p=g,o.innerHTML=g,n.style.display="block",a.textContent="✅ Response received!",u.value="",e.n=6;break;case 5:throw new Error("Failed to extract email body: "+r.error.message);case 6:return e.a(2)}}),t)})));return function(e){return t.apply(this,arguments)}}());case 2:t.n=4;break;case 3:t.p=3,y=t.v,console.error("Error in taskpane:",y),a.textContent="❌ Error: "+y.message;case 4:return t.a(2)}}),t,null,[[1,3]])})))),i.addEventListener("click",(function(){Office.context.mailbox.item.displayReplyForm(p)})),c.addEventListener("click",(function(){n.style.display="none",o.innerHTML="",p="",u.value="",a.textContent="🗑️ Response discarded."}))}))}(),function(){"use strict";new URL(n(58394),n.b)}()}();
//# sourceMappingURL=taskpane.js.map